(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      4529,        130]
NotebookOptionsPosition[      4153,        115]
NotebookOutlinePosition[      4577,        132]
CellTagsIndexPosition[      4534,        129]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"MP2", "[", 
   RowBox[{"nBas_", ",", "nO_", ",", "ERI_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ed", ",", "Ex", ",", "EcMP2"}], "}"}], ",", "\n", "\n", 
    RowBox[{"(*", 
     RowBox[{"Second", "-", 
      RowBox[{"order", " ", "ring", " ", "diagram"}]}], "*)"}], "\n", 
    RowBox[{
     RowBox[{"Ed", " ", "=", " ", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "nO"], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", "1"}], "nO"], 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"a", "=", 
           RowBox[{"nO", "+", "1"}]}], "nBas"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"b", "=", 
            RowBox[{"nO", "+", "1"}]}], "nBas"], 
          FractionBox[
           RowBox[{
            RowBox[{"ERI", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j", ",", "a", ",", "b"}], 
             "\[RightDoubleBracket]"}], "*", 
            RowBox[{"ERI", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j", ",", "a", ",", "b"}], 
             "\[RightDoubleBracket]"}]}], 
           RowBox[{
            RowBox[{
            "\[Epsilon]", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "+", 
            RowBox[{
            "\[Epsilon]", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}], "-", 
            RowBox[{
            "\[Epsilon]", "\[LeftDoubleBracket]", "a", 
             "\[RightDoubleBracket]"}], "-", 
            RowBox[{
            "\[Epsilon]", "\[LeftDoubleBracket]", "b", 
             "\[RightDoubleBracket]"}]}]]}]}]}]}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"Second", "-", 
       RowBox[{"order", " ", "exchange", " ", "diagram"}]}], "*)"}], "\n", 
     RowBox[{"Ex", " ", "=", " ", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "nO"], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", "1"}], "nO"], 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"a", "=", 
           RowBox[{"nO", "+", "1"}]}], "nBas"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"b", "=", 
            RowBox[{"nO", "+", "1"}]}], "nBas"], 
          FractionBox[
           RowBox[{
            RowBox[{"ERI", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j", ",", "a", ",", "b"}], 
             "\[RightDoubleBracket]"}], "*", 
            RowBox[{"ERI", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j", ",", "b", ",", "a"}], 
             "\[RightDoubleBracket]"}]}], 
           RowBox[{
            RowBox[{
            "\[Epsilon]", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "+", 
            RowBox[{
            "\[Epsilon]", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}], "-", 
            RowBox[{
            "\[Epsilon]", "\[LeftDoubleBracket]", "a", 
             "\[RightDoubleBracket]"}], "-", 
            RowBox[{
            "\[Epsilon]", "\[LeftDoubleBracket]", "b", 
             "\[RightDoubleBracket]"}]}]]}]}]}]}]}], ";", "\n", "\n", 
     RowBox[{"EcMP2", " ", "=", " ", 
      RowBox[{
       RowBox[{"2", "Ed"}], "-", "Ex"}]}], ";", "\n", "\n", 
     RowBox[{"Return", "[", "EcMP2", "]"}]}]}], "]"}]}]], "Code",
 CellChangeTimes->{{3.87284343162961*^9, 
  3.872843488592852*^9}},ExpressionUUID->"673e0324-64ef-4e55-ab0d-\
e6bd7a549ecb"]
},
WindowSize->{1004, 667},
WindowMargins->{{12, Automatic}, {Automatic, 46}},
Magnification:>1.5 Inherited,
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"655b202e-2bbc-4cd7-b5f6-71d49bbdb30b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3591, 93, 483, "Code",ExpressionUUID->"673e0324-64ef-4e55-ab0d-e6bd7a549ecb"]
}
]
*)

(* End of internal cache information *)

