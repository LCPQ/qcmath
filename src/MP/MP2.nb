(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      6846,        152]
NotebookOptionsPosition[      6469,        137]
NotebookOutlinePosition[      6865,        153]
CellTagsIndexPosition[      6822,        150]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MP2", "[", 
    RowBox[{
    "nO_", ",", "nV_", ",", "nBas_", ",", "EHF_", ",", "\[Epsilon]_", ",", 
     "U_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ERI", ",", "EcMP2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EcMP2", "=", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "1"}], "nO"], 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"j", "=", "1"}], "nO"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"a", "=", 
            RowBox[{"nO", "+", "1"}]}], "nBas"], 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"b", "=", 
             RowBox[{"nO", "+", "1"}]}], "nBas"], 
           FractionBox[
            RowBox[{
             RowBox[{"U", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j", ",", "a", ",", "b"}], 
              "\[RightDoubleBracket]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"U", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j", ",", "a", ",", "b"}], 
                 "\[RightDoubleBracket]"}]}], "-", 
               RowBox[{"U", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j", ",", "b", ",", "a"}], 
                "\[RightDoubleBracket]"}]}], ")"}]}], 
            RowBox[{
             RowBox[{
             "\[Epsilon]", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "+", 
             RowBox[{
             "\[Epsilon]", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}], "-", 
             RowBox[{
             "\[Epsilon]", "\[LeftDoubleBracket]", "a", 
              "\[RightDoubleBracket]"}], "-", 
             RowBox[{
             "\[Epsilon]", "\[LeftDoubleBracket]", "b", 
              "\[RightDoubleBracket]"}]}]]}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"TableForm", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<\!\(\*SuperscriptBox[\(E\), \(MP2\)]\) = \>\"", ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"EHF", "+", "EcMP2"}], ",", "15"}], "]"}], ",", 
           "\"\<\!\(\*SubsuperscriptBox[\(E\), \(c\), \(MP2\)]\) = \>\"", ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{"EcMP2", ",", "9"}], "]"}]}], "}"}], "}"}], "]"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"EHF", "+", "EcMP2"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.710780366738831*^9, 3.710780422847588*^9}, {
   3.7107804546237383`*^9, 3.7107804807592087`*^9}, {3.710780643278284*^9, 
   3.710780771406209*^9}, 3.7107808043790913`*^9, 3.710780994729097*^9, {
   3.710781070736425*^9, 3.7107810996902313`*^9}, {3.710781224888051*^9, 
   3.710781240600905*^9}, {3.710825669411783*^9, 3.710825692255085*^9}, {
   3.710825760994999*^9, 3.710825840979394*^9}, {3.710825987461465*^9, 
   3.710825990592465*^9}, {3.7108263807926064`*^9, 3.7108264032057323`*^9}, {
   3.710826586163746*^9, 3.710826587085247*^9}, {3.710836323200775*^9, 
   3.710836343502202*^9}, {3.710915746893414*^9, 3.710915756014353*^9}, {
   3.711094409279373*^9, 3.711094414886128*^9}, {3.711094509283826*^9, 
   3.7110945102878017`*^9}, 3.711094907305881*^9, {3.711779174371687*^9, 
   3.711779177126279*^9}, {3.71238127887078*^9, 3.712381282542109*^9}, {
   3.7123817232929373`*^9, 3.712381767364922*^9}, {3.71238229685061*^9, 
   3.712382312540503*^9}, {3.712382554190064*^9, 3.7123825643710623`*^9}, {
   3.71239009292022*^9, 3.712390101512433*^9}, {3.7123901815305023`*^9, 
   3.712390188782196*^9}, {3.712390228012658*^9, 3.7123902374519033`*^9}, 
   3.712390270930481*^9, {3.7123970133984613`*^9, 3.712397021438074*^9}, {
   3.712398811304103*^9, 3.71239881287035*^9}, {3.712400388432806*^9, 
   3.71240038956849*^9}, {3.71246723415059*^9, 3.71246728440486*^9}, 
   3.7124800921830473`*^9, {3.7127351956712437`*^9, 3.712735202169161*^9}, {
   3.730647629262978*^9, 3.7306476295966787`*^9}, 3.730657568139688*^9, {
   3.747376227040062*^9, 3.74737626639224*^9}, {3.74737630578514*^9, 
   3.7473765056620417`*^9}, {3.747377214135858*^9, 3.747377519157135*^9}, {
   3.747377555193694*^9, 3.747377609119087*^9}, {3.747377657039979*^9, 
   3.747377686277419*^9}, {3.747379205887147*^9, 3.74737920614929*^9}, {
   3.74739528845533*^9, 3.747395290719013*^9}, {3.7474691971977367`*^9, 
   3.747469635518475*^9}, {3.747469816758253*^9, 3.7474702876899223`*^9}, {
   3.74747035860301*^9, 3.747470482992972*^9}, {3.747470525788085*^9, 
   3.7474705930983763`*^9}, {3.747470706443137*^9, 3.74747073013832*^9}, 
   3.747470972213291*^9, {3.747471075121972*^9, 3.747471079934902*^9}, {
   3.747471180154992*^9, 3.747471219248012*^9}, {3.7474712873850183`*^9, 
   3.747471347869273*^9}, {3.747471400047842*^9, 3.747471405656447*^9}, {
   3.747471466070959*^9, 3.7474714712712917`*^9}, {3.7474715665840797`*^9, 
   3.747471595846875*^9}, 3.747471761384241*^9, {3.747471818648275*^9, 
   3.747471897445842*^9}, {3.747471931183401*^9, 3.747472126423106*^9}, {
   3.747472657911996*^9, 3.747472709519569*^9}, {3.747472745583127*^9, 
   3.7474727627596607`*^9}, {3.7474728059278383`*^9, 
   3.7474729155122023`*^9}, {3.747472968048609*^9, 3.747473003878965*^9}, {
   3.747473070191592*^9, 3.7474731282149467`*^9}, {3.747473470239451*^9, 
   3.747473622662587*^9}, {3.747473701150476*^9, 3.747473771526614*^9}, {
   3.7474949689393253`*^9, 3.747495056312213*^9}, {3.747758939583661*^9, 
   3.7477590216886806`*^9}, {3.747759055527005*^9, 3.747759096528942*^9}, {
   3.864140391094729*^9, 
   3.864140418293544*^9}},ExpressionUUID->"c9a076eb-bf4f-49a7-a940-\
e883523bff4f"]
},
WindowSize->{808, 747},
WindowMargins->{{12, Automatic}, {Automatic, 24}},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"75c27a22-dfcc-4c29-9ceb-8433c35e2028"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5907, 115, 227, "Input",ExpressionUUID->"c9a076eb-bf4f-49a7-a940-e883523bff4f",
 InitializationCell->True]
}
]
*)

