(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      4945,        141]
NotebookOptionsPosition[      4568,        126]
NotebookOutlinePosition[      4964,        142]
CellTagsIndexPosition[      4921,        139]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MP2", "[", 
    RowBox[{
    "O_", ",", "V_", ",", "K_", ",", "EHF_", ",", "\[Epsilon]_", ",", 
     "ERI_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"E2d", ",", "E2x", ",", "EcMP2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"E2d", "=", 
       RowBox[{"2", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "O"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "O"], 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"a", "=", 
             RowBox[{"O", "+", "1"}]}], "K"], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"b", "=", 
              RowBox[{"O", "+", "1"}]}], "K"], 
            FractionBox[
             SuperscriptBox[
              RowBox[{"ERI", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j", ",", "a", ",", "b"}], 
               "\[RightDoubleBracket]"}], "2"], 
             RowBox[{
              RowBox[{
              "\[Epsilon]", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "+", 
              RowBox[{
              "\[Epsilon]", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}], "-", 
              RowBox[{
              "\[Epsilon]", "\[LeftDoubleBracket]", "a", 
               "\[RightDoubleBracket]"}], "-", 
              RowBox[{
              "\[Epsilon]", "\[LeftDoubleBracket]", "b", 
               "\[RightDoubleBracket]"}]}]]}]}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"E2x", "=", 
       RowBox[{"-", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "O"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "O"], 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"a", "=", 
             RowBox[{"O", "+", "1"}]}], "K"], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"b", "=", 
              RowBox[{"O", "+", "1"}]}], "K"], 
            FractionBox[
             RowBox[{
              RowBox[{"ERI", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j", ",", "a", ",", "b"}], 
               "\[RightDoubleBracket]"}], 
              RowBox[{"ERI", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j", ",", "b", ",", "a"}], 
               "\[RightDoubleBracket]"}]}], 
             RowBox[{
              RowBox[{
              "\[Epsilon]", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "+", 
              RowBox[{
              "\[Epsilon]", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}], "-", 
              RowBox[{
              "\[Epsilon]", "\[LeftDoubleBracket]", "a", 
               "\[RightDoubleBracket]"}], "-", 
              RowBox[{
              "\[Epsilon]", "\[LeftDoubleBracket]", "b", 
               "\[RightDoubleBracket]"}]}]]}]}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EcMP2", "=", 
       RowBox[{"E2d", "+", "E2x"}]}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{"TableForm", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<\!\(\*SuperscriptBox[\(E\), \(MP2\)]\) = \>\"", ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"EHF", "+", "EcMP2"}], ",", "15"}], "]"}], ",", 
           "\"\<\!\(\*SubsuperscriptBox[\(E\), \(c\), \(MP2\)]\) = \>\"", ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{"EcMP2", ",", "9"}], "]"}]}], "}"}], "}"}], "]"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"EHF", "+", "EcMP2"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[3]:=",ExpressionUUID->"c9a076eb-bf4f-49a7-a940-e883523bff4f"]
},
WindowSize->{808, 747},
WindowMargins->{{12, Automatic}, {Automatic, 24}},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"75c27a22-dfcc-4c29-9ceb-8433c35e2028"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4006, 104, 303, "Input",ExpressionUUID->"c9a076eb-bf4f-49a7-a940-e883523bff4f",
 InitializationCell->True]
}
]
*)

