(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    105385,       2609]
NotebookOptionsPosition[    104432,       2583]
NotebookOutlinePosition[    104857,       2600]
CellTagsIndexPosition[    104814,       2597]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["EOM-CCSD", "Title",
 CellChangeTimes->{{3.896070162219326*^9, 
  3.896070165456346*^9}},ExpressionUUID->"1e809a08-7a6d-41b5-8fce-\
b85547656349"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EOMCCSD", "[", 
    RowBox[{
    "nElec_", ",", "nBas_", ",", "\[Epsilon]_", ",", "h_", ",", "ERI_", ",", 
     "t1_", ",", "t2_", ",", "EHF_", ",", "options_", ",", "verbose_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "outputsEOMCCSD", "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"options", "[", "\"\<spinorbital\>\"", "]"}], "\[Equal]", 
         "True"}], ",", "\n", "\n", "  ", 
        RowBox[{
         RowBox[{"outputsEOMCCSD", "=", 
          RowBox[{"spinOrbEOMCCSD", "[", 
           RowBox[{
           "nElec", ",", "nBas", ",", "\[Epsilon]", ",", "h", ",", "ERI", ",",
             "t1", ",", "t2", ",", "EHF", ",", "verbose"}], "]"}]}], ";"}], 
        "\n", "  ", "\n", "  ", ",", 
        RowBox[{"(*", 
         RowBox[{"else", " ", "go", " ", "to", " ", "spatial"}], "*)"}], "\n",
         "  ", "\n", "  ", 
        RowBox[{
         RowBox[{"outputsEOMCCSD", "=", 
          RowBox[{"spatialOrbEOMCCSD", "[", 
           RowBox[{
           "nElec", ",", "nBas", ",", "\[Epsilon]", ",", "h", ",", "ERI", ",",
             "t1", ",", "t2", ",", "EHF", ",", "verbose"}], "]"}]}], ";"}]}], 
       "\n", "  ", "\n", "]"}], ";", "\n", "  ", "\n", 
      RowBox[{"Return", "[", "outputsEOMCCSD", "]"}], ";"}]}], "\n", "  ", 
    "\n", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.896070193404374*^9, 3.896070203885241*^9}, {
  3.8960702458328*^9, 3.896070252750657*^9}, {3.89607056803407*^9, 
  3.896070571585203*^9}, {3.896070647445491*^9, 3.89607067606887*^9}, {
  3.896152765118464*^9, 
  3.896152767006781*^9}},ExpressionUUID->"d6f5c358-17e3-4e46-bcc8-\
197c16b2e72d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spin orbitals", "Title",
 CellChangeTimes->{{3.896070168050969*^9, 
  3.896070174851576*^9}},ExpressionUUID->"f7361ed6-fe61-4df6-bfd0-\
2f4e3942a90a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"spinOrbEOMCCSD", "[", 
    RowBox[{
    "nElec_", ",", "nBas_", ",", "\[Epsilon]_", ",", "h_", ",", "ERI_", ",", 
     "t1_", ",", "t2_", ",", "EHF_", ",", "verbose_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "NB", ",", "nO", ",", "nV", ",", "H", ",", "soERI", ",", "F", ",", 
       "\[Chi]1", ",", "\[Chi]2", ",", "\[Chi]3", ",", "nS", ",", "nD", ",", 
       "nH", ",", "HCC", ",", "ia", ",", "iajb", ",", "kc", ",", "kcld", ",", 
       "ECC", ",", "outputsEOMCCSD"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"NB", "=", 
       RowBox[{"2", "nBas"}]}], ";", "\t", 
      RowBox[{"nO", "=", "nElec"}], ";", "\t", 
      RowBox[{"nV", "=", 
       RowBox[{"NB", "-", "nO"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Spin", "-", 
        RowBox[{"orbital", " ", "integrals"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"H", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Delta]", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"p", ",", "2"}], "]"}], ",", 
            RowBox[{"Mod", "[", 
             RowBox[{"q", ",", "2"}], "]"}]}]], 
          RowBox[{"h", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"\[LeftFloor]", 
             FractionBox[
              RowBox[{"p", "+", "1"}], "2"], "\[RightFloor]"}], ",", 
            RowBox[{"\[LeftFloor]", 
             FractionBox[
              RowBox[{"q", "+", "1"}], "2"], "\[RightFloor]"}]}], 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "NB"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soERI", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Delta]", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"p", ",", "2"}], "]"}], ",", 
            RowBox[{"Mod", "[", 
             RowBox[{"r", ",", "2"}], "]"}]}]], 
          SubscriptBox["\[Delta]", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"s", ",", "2"}], "]"}], ",", 
            RowBox[{"Mod", "[", 
             RowBox[{"q", ",", "2"}], "]"}]}]], 
          RowBox[{"ERI", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"\[LeftFloor]", 
             FractionBox[
              RowBox[{"p", "+", "1"}], "2"], "\[RightFloor]"}], ",", 
            RowBox[{"\[LeftFloor]", 
             FractionBox[
              RowBox[{"q", "+", "1"}], "2"], "\[RightFloor]"}], ",", 
            RowBox[{"\[LeftFloor]", 
             FractionBox[
              RowBox[{"r", "+", "1"}], "2"], "\[RightFloor]"}], ",", 
            RowBox[{"\[LeftFloor]", 
             FractionBox[
              RowBox[{"s", "+", "1"}], "2"], "\[RightFloor]"}]}], 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "NB"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soERI", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"soERI", "\[LeftDoubleBracket]", 
           RowBox[{"p", ",", "q", ",", "r", ",", "s"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"soERI", "\[LeftDoubleBracket]", 
           RowBox[{"p", ",", "q", ",", "s", ",", "r"}], 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "NB"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"F", "=", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "\[LeftDoubleBracket]", 
           RowBox[{"\[LeftFloor]", 
            FractionBox[
             RowBox[{"p", "+", "1"}], "2"], "\[RightFloor]"}], 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "NB"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"One", " ", "Body", " ", "Terms"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Chi]1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "NB"}], "}"}]}], "]"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]1", "[", 
          RowBox[{"[", 
           RowBox[{"h3", ",", "h1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"F", "[", 
            RowBox[{"[", 
             RowBox[{"h3", ",", "h1"}], "]"}], "]"}]}], "\n", 
          "               ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"F", "[", 
               RowBox[{"[", 
                RowBox[{"h3", ",", 
                 RowBox[{"nO", " ", "+", " ", "v1"}]}], "]"}], "]"}]}], "*", 
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h1", ",", "v1"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "               ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", 
                RowBox[{"nO", " ", "+", " ", "v1"}], ",", "h1"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "               ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h1", ",", "v2"}], "]"}], "]"}], "*", 
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "v2"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "               ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "o1", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "v2"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "h1", ",", "v1", ",", "v2"}], "]"}], 
                "]"}]}], ")"}], "/", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "1", ",", "nV"}], "}"}]}], "]"}]}]}], "\n", 
        ",", 
        RowBox[{"{", 
         RowBox[{"h3", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h1", ",", "nO"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"p1", "+", "nO"}], ",", 
            RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"nO", "+", "p1"}], ",", 
             RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "\n", 
          "                     ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"F", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "p1"}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                     ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", 
                RowBox[{"nO", "+", "p1"}], ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                     ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o2", ",", "p1"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "o2", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o2", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                     ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "o2", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o2", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}]}]}], "   ", 
        "\n", ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p3", ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]1", "[", 
          RowBox[{"[", 
           RowBox[{"h4", ",", 
            RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"[", 
            RowBox[{"h4", ",", 
             RowBox[{"nO", "+", "p4"}]}], "]"}], "]"}], "\n", 
          "                  ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "o1", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p4"}]}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}]}]}], "\n", 
        ",", 
        RowBox[{"{", 
         RowBox[{"h4", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p4", ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"two", "-", 
        RowBox[{"body", " ", "Terms"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Chi]2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "NB"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]2", "[", 
          RowBox[{"[", 
           RowBox[{"h3", ",", 
            RowBox[{"p1", "+", "nO"}], ",", "h1", ",", 
            RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"soERI", "[", 
            RowBox[{"[", 
             RowBox[{"h3", ",", 
              RowBox[{"nO", "+", "p1"}], ",", "h1", ",", 
              RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], "\n", 
          "                           ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", "h1", ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                           ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"nO", "+", "p1"}], ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                           ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h1", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                           ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "o1", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "h1", ",", "v1", ",", "p1"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}]}]}], "\n", 
        ",", 
        RowBox[{"{", 
         RowBox[{"h3", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h1", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p3", ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]2", "[", 
          RowBox[{"[", 
           RowBox[{"h4", ",", "h3", ",", "h1", ",", 
            RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"soERI", "[", 
           RowBox[{"[", 
            RowBox[{"h4", ",", " ", "h3", ",", " ", "h1", ",", 
             RowBox[{"nO", "+", "p4"}]}], "]"}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h1", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h4", ",", "h3", ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p4"}]}], "]"}], "]"}]}], " ", ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}]}]}], "   ", 
        "\n", ",", 
        RowBox[{"{", 
         RowBox[{"h4", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h3", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h1", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p4", ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]2", "[", 
          RowBox[{"[", 
           RowBox[{"h4", ",", 
            RowBox[{"p1", "+", "nO"}], ",", 
            RowBox[{"p4", "+", "nO"}], ",", 
            RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"soERI", "[", 
           RowBox[{"[", 
            RowBox[{"h4", ",", 
             RowBox[{"nO", "+", "p1"}], ",", 
             RowBox[{"nO", "+", "p4"}], ",", 
             RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "\n", 
          "                             ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "p1"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "o1", ",", 
                  RowBox[{"nO", "+", "p4"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}]}]}], "\n", 
        ",", 
        RowBox[{"{", 
         RowBox[{"h4", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p4", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p3", ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]2", "[", 
          RowBox[{"[", 
           RowBox[{"h3", ",", 
            RowBox[{"p2", "+", "nO"}], ",", "h2", ",", "h1"}], "]"}], "]"}], 
         "=", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"F", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"nO", "+", "v1"}]}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "h2", ",", "v1", ",", "p2"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"-", 
           RowBox[{"soERI", "[", 
            RowBox[{"[", 
             RowBox[{"h3", ",", 
              RowBox[{"nO", "+", "p2"}], ",", "h1", ",", "h2"}], "]"}], 
            "]"}]}], "\n", "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", "h1", ",", "h2"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"nO", "+", "p2"}], ",", 
                  RowBox[{"nO", "+", "v1"}], ",", "h2"}], "]"}], "]"}]}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h2", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", 
                RowBox[{"nO", "+", "p2"}], ",", 
                RowBox[{"nO", "+", "v1"}], ",", "h1"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h1", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", 
                RowBox[{"nO", "+", "v1"}], ",", "h2"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h2", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "o1", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", "h1"}], "]"}], "]"}]}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h2", ",", "v2"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"nO", "+", "p2"}], ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "v2"}]}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h1", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h2", ",", "v2"}], "]"}], "]"}], "*", 
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "v2"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "o1", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", "h2"}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "h1", ",", "v1", ",", "p2"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", 
                RowBox[{"nO", "+", "v1"}], ",", "h1"}], "]"}], "]"}], "*", 
             RowBox[{"t2", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "h2", ",", "v1", ",", "p2"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"nO", "+", "p2"}], ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "v2"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "v2"}]}], "]"}], "]"}], "*", 
             RowBox[{"t2", "[", 
              RowBox[{"[", 
               RowBox[{"h1", ",", "h2", ",", "v2", ",", "p2"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "o1", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "v2"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], "]"}], 
                "]"}]}], ")"}], "/", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "o1", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "v2"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "h2", ",", "v2", ",", "p2"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                        ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h2", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "v2"}]}], "]"}], "]"}], "*", 
             RowBox[{"t2", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "h1", ",", "v2", ",", "p2"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "1", ",", "nV"}], "}"}]}], "]"}]}]}], "\n", 
        ",", 
        RowBox[{"{", 
         RowBox[{"h3", ",", " ", "nO"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"p2", ",", " ", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h2", ",", " ", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h1", ",", " ", "nO"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]2", "[", 
          RowBox[{"[", 
           RowBox[{"h4", ",", "h3", ",", "h2", ",", "h1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"soERI", "[", 
            RowBox[{"[", 
             RowBox[{"h4", ",", "h3", ",", "h1", ",", "h2"}], "]"}], "]"}]}], 
          "\n", "                     ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h3", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", "h2"}], "]"}], "]"}]}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                     ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h2", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h4", ",", "h3", ",", 
                RowBox[{"nO", "+", "v1"}], ",", "h1"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                     ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h2", ",", "v2"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h3", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "v2"}]}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                     ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h3", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "v2"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "1", ",", "nV"}], "}"}]}], "]"}]}]}], "\n", 
        ",", 
        RowBox[{"{", 
         RowBox[{"h4", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h3", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h2", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h1", ",", "nO"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"p2", "+", "nO"}], ",", 
            RowBox[{"p1", "+", "nO"}], ",", "h2", ",", 
            RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"F", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
             RowBox[{"t2", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "h2", ",", "p2", ",", "p1"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"soERI", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"nO", "+", "p2"}], ",", 
             RowBox[{"nO", "+", "p1"}], ",", "h2", ",", 
             RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", 
                  RowBox[{"nO", "+", "p1"}], ",", "h2", ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", 
                RowBox[{"nO", "+", "p2"}], ",", "h2", ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h2", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"nO", "+", "p2"}], ",", 
                RowBox[{"nO", "+", "p1"}], ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o2", ",", "p1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "o2", ",", "h2", ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o2", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h2", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", 
                  RowBox[{"nO", "+", "p1"}], ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h2", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", 
                RowBox[{"nO", "+", "p2"}], ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h2", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o2", ",", "p1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "o2", ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o2", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "o2", ",", "h2", ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], "]"}], 
                "]"}]}], ")"}], "/", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o2", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", 
                RowBox[{"nO", "+", "p1"}], ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
             RowBox[{"t2", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "h2", ",", "v1", ",", "p2"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", 
                  RowBox[{"nO", "+", "p2"}], ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "h2", ",", "v1", ",", "p1"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "o2", ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
             RowBox[{"t2", "[", 
              RowBox[{"[", 
               RowBox[{"o2", ",", "h2", ",", "p2", ",", "p1"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o2", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "o2", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o2", ",", "h2", ",", "v1", ",", "p1"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o2", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "o2", ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
             RowBox[{"t2", "[", 
              RowBox[{"[", 
               RowBox[{"o2", ",", "h2", ",", "v1", ",", "p2"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o2", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                              ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h2", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "o2", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], "]"}], 
                "]"}]}], ")"}], "/", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o2", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}]}]}], "  ", 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"p2", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h2", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p3", ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"p2", "+", "nO"}], ",", 
            RowBox[{"p1", "+", "nO"}], ",", 
            RowBox[{"p4", "+", "nO"}], ",", 
            RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"soERI", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"nO", "+", "p2"}], ",", 
             RowBox[{"nO", "+", "p1"}], ",", 
             RowBox[{"nO", "+", "p4"}], ",", 
             RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "\n", 
          "                                 ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", 
                  RowBox[{"nO", "+", "p1"}], ",", 
                  RowBox[{"nO", "+", "p4"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                                 ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", 
                RowBox[{"nO", "+", "p2"}], ",", 
                RowBox[{"nO", "+", "p4"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                                 ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o2", ",", "p1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "o2", ",", 
                RowBox[{"nO", "+", "p4"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o2", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                                 ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "o2", ",", 
                  RowBox[{"nO", "+", "p4"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], "]"}], 
                "]"}]}], ")"}], "/", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o2", ",", "1", ",", "nO"}], "}"}]}], "]"}]}]}], "\n", 
        ",", 
        RowBox[{"{", 
         RowBox[{"p2", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p4", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p3", ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"three", "-", 
        RowBox[{"body", " ", "Terms"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Chi]3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "NB"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"u", ",", "NB"}], "}"}]}], "]"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]3", "[", 
          RowBox[{"[", 
           RowBox[{"h4", ",", "h3", ",", 
            RowBox[{"p2", "+", "nO"}], ",", "h2", ",", "h1", ",", 
            RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"soERI", "[", 
             RowBox[{"[", 
              RowBox[{"h4", ",", "h3", ",", 
               RowBox[{"nO", "+", "v1"}], ",", 
               RowBox[{"nO", "+", "p4"}]}], "]"}], "]"}], "*", 
            RowBox[{"t2", "[", 
             RowBox[{"[", 
              RowBox[{"h1", ",", "h2", ",", "v1", ",", "p2"}], "]"}], "]"}]}],
            ",", 
           RowBox[{"{", 
            RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}]}], "\n", ",", 
        
        RowBox[{"{", 
         RowBox[{"h4", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h3", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p2", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h2", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h1", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p4", ",", " ", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]3", "[", 
          RowBox[{"[", 
           RowBox[{"h4", ",", 
            RowBox[{"p2", "+", "nO"}], ",", 
            RowBox[{"p1", "+", "nO"}], ",", "h2", ",", 
            RowBox[{"p4", "+", "nO"}], ",", 
            RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"soERI", "[", 
             RowBox[{"[", 
              RowBox[{"h4", ",", "o1", ",", 
               RowBox[{"nO", "+", "p4"}], ",", 
               RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
            RowBox[{"t2", "[", 
             RowBox[{"[", 
              RowBox[{"o1", ",", "h2", ",", "p2", ",", "p1"}], "]"}], "]"}]}],
            ",", 
           RowBox[{"{", 
            RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}]}], "\n", ",", 
        
        RowBox[{"{", 
         RowBox[{"h4", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p2", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h2", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p4", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p3", ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]3", "[", 
          RowBox[{"[", 
           RowBox[{"h3", ",", 
            RowBox[{"p2", "+", "nO"}], ",", 
            RowBox[{"p1", "+", "nO"}], ",", "h2", ",", "h1", ",", 
            RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", "h2", ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
             RowBox[{"t2", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "h1", ",", "p2", ",", "p1"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                                    ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "o1", ",", "h1", ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "h2", ",", "p2", ",", "p1"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}]}], "]"}], "\n", 
          "                                    ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"nO", "+", "p1"}], ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "h2", ",", "v1", ",", "p2"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                                    ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", 
                RowBox[{"nO", "+", "p2"}], ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
             RowBox[{"t2", "[", 
              RowBox[{"[", 
               RowBox[{"h1", ",", "h2", ",", "v1", ",", "p1"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                                    ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "p2"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "o1", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "h2", ",", "v1", ",", "p1"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                                    ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "p1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
             RowBox[{"t2", "[", 
              RowBox[{"[", 
               RowBox[{"h1", ",", "h2", ",", "v1", ",", "p2"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                                    ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t1", "[", 
                RowBox[{"[", 
                 RowBox[{"h1", ",", "v1"}], "]"}], "]"}], "*", 
               RowBox[{"soERI", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "o1", ",", 
                  RowBox[{"nO", "+", "v1"}], ",", 
                  RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
               RowBox[{"t2", "[", 
                RowBox[{"[", 
                 RowBox[{"o1", ",", "h2", ",", "p2", ",", "p1"}], "]"}], 
                "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}], "\n", 
          "                                    ", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", 
               RowBox[{"h2", ",", "v1"}], "]"}], "]"}], "*", 
             RowBox[{"soERI", "[", 
              RowBox[{"[", 
               RowBox[{"h3", ",", "o1", ",", 
                RowBox[{"nO", "+", "v1"}], ",", 
                RowBox[{"nO", "+", "p3"}]}], "]"}], "]"}], "*", 
             RowBox[{"t2", "[", 
              RowBox[{"[", 
               RowBox[{"o1", ",", "h1", ",", "p2", ",", "p1"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o1", ",", "1", ",", "nO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "1", ",", "nV"}], "}"}]}], "]"}]}]}], "\n", 
        ",", 
        RowBox[{"{", 
         RowBox[{"h3", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p2", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h2", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h1", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p3", ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Form", " ", "dressed", " ", "Hamiltonian", " ", "matrix"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"nS", "=", 
       RowBox[{"nO", " ", "nV"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nD", "=", 
       RowBox[{
        RowBox[{"+", 
         FractionBox[
          RowBox[{"nO", 
           RowBox[{"(", 
            RowBox[{"nO", "-", "1"}], ")"}]}], "2"]}], 
        FractionBox[
         RowBox[{"nV", 
          RowBox[{"(", 
           RowBox[{"nV", "-", "1"}], ")"}]}], "2"]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nH", "=", 
       RowBox[{"nS", "+", "nD"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HCC", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "nH"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "nH"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"SS", " ", "block"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ia", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ia", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"kc", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"kc", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"HCC", "\[LeftDoubleBracket]", 
              RowBox[{"ia", ",", "kc"}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "h1"}], "]"}], "]"}]}], "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p1", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "+", 
              RowBox[{"\[Chi]2", "[", 
               RowBox[{"[", 
                RowBox[{"h3", ",", 
                 RowBox[{"p1", "+", "nO"}], ",", "h1", ",", 
                 RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}]}]}], " ", 
           "\[IndentingNewLine]", ",", " ", 
           RowBox[{"{", 
            RowBox[{"h3", ",", " ", "nO"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p3", ",", " ", "nV"}], "}"}]}], "]"}]}], " ", 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"h1", ",", " ", "nO"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"p1", ",", " ", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"SD", " ", "blocks"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"ia", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ia", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"kcld", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"kcld", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"HCC", "\[LeftDoubleBracket]", 
              RowBox[{"ia", ",", 
               RowBox[{"nS", "+", "kcld"}]}], "\[RightDoubleBracket]"}], "=", 
             
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", 
                  RowBox[{"p4", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h3", ",", "h1", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h3", ",", "h1", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", 
                  RowBox[{"p4", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}]}]}]}], " ", 
           "\n", ",", 
           RowBox[{"{", 
            RowBox[{"h3", ",", "nO"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p3", ",", "nV"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"h4", ",", 
             RowBox[{"h3", "+", "1"}], ",", "nO"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p4", ",", 
             RowBox[{"p3", "+", "1"}], ",", "nV"}], "}"}]}], "]"}]}], " ", 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"h1", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"DS", " ", "blocks"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"iajb", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"iajb", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"kc", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"kc", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"HCC", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"nS", "+", "iajb"}], ",", "kc"}], 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SubscriptBox["\[Delta]", 
                 RowBox[{"p2", ",", "p3"}]]}], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h2", ",", "h1"}], "]"}], 
                "]"}]}], "\n", "                ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", "h2", ",", "h1"}], "]"}], 
                "]"}]}], "\n", "                ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h1", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h2", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], " ", "\n", 
              "                ", "+", 
              RowBox[{"\[Chi]3", "[", 
               RowBox[{"[", 
                RowBox[{"h3", ",", 
                 RowBox[{"p2", "+", "nO"}], ",", 
                 RowBox[{"p1", "+", "nO"}], ",", "h2", ",", "h1", ",", 
                 RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}]}]}], "\n", ",", 
           RowBox[{"{", 
            RowBox[{"h3", ",", "nO"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p3", ",", "nV"}], "}"}]}], "]"}]}], " ", 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"h1", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h2", ",", 
          RowBox[{"h1", "+", "1"}], ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p2", ",", 
          RowBox[{"p1", "+", "1"}], ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"DD", " ", "blocks"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"iajb", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"iajb", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"kcld", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"kcld", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"HCC", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"nS", "+", "iajb"}], ",", 
               RowBox[{"nS", "+", "kcld"}]}], "\[RightDoubleBracket]"}], "=", 
             
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SubscriptBox["\[Delta]", 
                 RowBox[{"h2", ",", "h4"}]]}], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "h1"}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "h1"}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "h2"}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", "h2"}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h1"}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h1"}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h2"}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h2"}], "]"}], "]"}]}], "\n", 
              "                     ", "-", " ", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p1", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p1", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p1", "+", "nO"}], ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p1", "+", "nO"}], ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]1", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h1", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h1", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h2", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h2", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", "h1", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", "h1", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", "h2", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", "h2", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h3", ",", "h2", ",", "h1"}], "]"}], 
                "]"}]}], "\n", "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h3", ",", "h2", ",", "h1"}], "]"}], 
                "]"}]}], "\n", "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h1", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h1", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h2", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h2", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", "h1", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", "h1", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", "h2", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", "h2", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p1", "+", "nO"}], ",", 
                  RowBox[{"p4", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], 
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h4"}]], "*", 
               RowBox[{"\[Chi]2", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p1", "+", "nO"}], ",", 
                  RowBox[{"p4", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h4"}]], "*", 
               RowBox[{"\[Chi]3", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h1", ",", 
                  RowBox[{"p4", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h4"}]], "*", 
               RowBox[{"\[Chi]3", "[", 
                RowBox[{"[", 
                 RowBox[{"h3", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h2", ",", 
                  RowBox[{"p4", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]3", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h3", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h2", ",", "h1", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"p2", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]3", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h3", ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h2", ",", "h1", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], " ", "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p4"}]], "*", 
               RowBox[{"\[Chi]3", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h3", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", "h2", ",", "h1", ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], " ", "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"p1", ",", "p3"}]], "*", 
               RowBox[{"\[Chi]3", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", "h3", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", "h2", ",", "h1", ",", 
                  RowBox[{"p4", "+", "nO"}]}], "]"}], "]"}]}], " ", "\n", 
              "                     ", "-", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h2", ",", "h3"}]], "*", 
               RowBox[{"\[Chi]3", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h1", ",", 
                  RowBox[{"p4", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}], " ", "\n", 
              "                     ", "+", 
              RowBox[{
               SubscriptBox["\[Delta]", 
                RowBox[{"h1", ",", "h3"}]], "*", 
               RowBox[{"\[Chi]3", "[", 
                RowBox[{"[", 
                 RowBox[{"h4", ",", 
                  RowBox[{"p2", "+", "nO"}], ",", 
                  RowBox[{"p1", "+", "nO"}], ",", "h2", ",", 
                  RowBox[{"p4", "+", "nO"}], ",", 
                  RowBox[{"p3", "+", "nO"}]}], "]"}], "]"}]}]}]}]}], " ", 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"h3", ",", "nO"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p3", ",", "nV"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"h4", ",", 
             RowBox[{"h3", "+", "1"}], ",", "nO"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p4", ",", 
             RowBox[{"p3", "+", "1"}], ",", "nV"}], "}"}]}], "]"}]}], " ", 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"h1", ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "nV"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h2", ",", 
          RowBox[{"h1", "+", "1"}], ",", "nO"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p2", ",", 
          RowBox[{"p1", "+", "1"}], ",", "nV"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", " ", "options"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ECC", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Eigenvalues", "[", "HCC", "]"}], "]"}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"verbose", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<EOMCC eigenvalues\>\"", ",", "Bold", ",", "Purple"}], 
           "]"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "ECC", "]"}], ";"}]}], "\n", "]"}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"outputsEOMCCSD", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"\"\<ECC\>\"", "\[Rule]", "ECC"}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"Return", "[", "outputsEOMCCSD", "]"}]}]}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.896070261403871*^9, 3.896070271567816*^9}, {
   3.896070695052794*^9, 3.896070695415784*^9}, {3.896070767435004*^9, 
   3.896070768466165*^9}, {3.896070835520977*^9, 3.896071157510054*^9}, 
   3.8960714057540417`*^9, 3.896071534007717*^9, {3.896144761236733*^9, 
   3.8961447619609737`*^9}, {3.896144799596367*^9, 3.896144839887388*^9}, {
   3.8961449063456163`*^9, 3.896144940953743*^9}, {3.8961449718332443`*^9, 
   3.8961475728726673`*^9}, {3.8961476085341387`*^9, 3.896148042882207*^9}, {
   3.896148288299024*^9, 3.896148303799264*^9}, 3.896148528466661*^9, 
   3.8961486498138657`*^9, 3.896148684518113*^9, {3.896148837739019*^9, 
   3.896148872073577*^9}, {3.8961493810145693`*^9, 3.896149443490934*^9}, 
   3.896149520600498*^9, {3.896150009948595*^9, 3.896150022303542*^9}, {
   3.896152770901867*^9, 
   3.896152776350171*^9}},ExpressionUUID->"5156c8dc-e809-433b-a89f-\
f8d5ca3a8727"]
}, Closed]],

Cell[CellGroupData[{

Cell["Spatial orbitals", "Title",
 CellChangeTimes->{{3.89607017676762*^9, 
  3.8960701822347383`*^9}},ExpressionUUID->"2a88e845-8dc9-4b66-9dc8-\
838530fa00d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"spatialOrbEOMCCSD", "[", 
    RowBox[{
    "nElec_", ",", "nBas_", ",", "\[Epsilon]_", ",", "h_", ",", "ERI_", ",", 
     "t1_", ",", "t2_", ",", "EHF_", ",", "verbose_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"Return", "[", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<spatial orbital implementation not available!!!\>\"", ",", 
          "Bold", ",", "Red"}], "]"}], "]"}], "]"}], ";"}]}], "\n", "\n", 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.896070457684143*^9, 3.896070469200184*^9}, {
   3.896070697487426*^9, 3.896070697916676*^9}, {3.896070750663829*^9, 
   3.896070772930525*^9}, 3.896152801426443*^9, 
   3.898223932782987*^9},ExpressionUUID->"311816d3-1a42-46ce-91d3-\
99288389c9b1"]
}, Closed]]
},
WindowSize->{1248, 688},
WindowMargins->{{Automatic, 41}, {17, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"db85b43a-633e-4afb-b394-5441cdc1c2d4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 151, 3, 123, "Title",ExpressionUUID->"1e809a08-7a6d-41b5-8fce-b85547656349"],
Cell[734, 27, 1745, 41, 402, "Code",ExpressionUUID->"d6f5c358-17e3-4e46-bcc8-197c16b2e72d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2516, 73, 156, 3, 123, "Title",ExpressionUUID->"f7361ed6-fe61-4df6-bfd0-2f4e3942a90a"],
Cell[2675, 78, 100653, 2470, 5882, "Code",ExpressionUUID->"5156c8dc-e809-433b-a89f-f8d5ca3a8727"]
}, Closed]],
Cell[CellGroupData[{
Cell[103365, 2553, 160, 3, 89, "Title",ExpressionUUID->"2a88e845-8dc9-4b66-9dc8-838530fa00d4"],
Cell[103528, 2558, 888, 22, 162, "Code",ExpressionUUID->"311816d3-1a42-46ce-91d3-99288389c9b1"]
}, Closed]]
}
]
*)

