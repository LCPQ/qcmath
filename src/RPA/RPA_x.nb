(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      4366,        115]
NotebookOptionsPosition[      3990,        100]
NotebookOutlinePosition[      4414,        117]
CellTagsIndexPosition[      4371,        114]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RPAx", "[", 
    RowBox[{
    "nBas_", ",", "nO_", ",", "nV_", ",", "\[Epsilon]_", ",", "ERI_", ",", 
     "TDA_", ",", 
     RowBox[{"(*", 
      RowBox[{"BSE_", ",", "W_", ","}], "*)"}], "singlet_", ",", "triplet_"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ispin", ",", "linearquantities", ",", "Ecsinglet", ",", "Ectriplet", 
       ",", "dRPA", ",", "RPAxquantities", ",", "EcRPAx"}], "}"}], ",", "\n", 
     "\n", 
     RowBox[{
      RowBox[{
      "NotebookEvaluate", "[", 
       "\"\<~/Work/qcmath/src/LR/linear_Response.nb\>\"", "]"}], ";", "\n", 
      "\n", 
      RowBox[{"Ecsinglet", "=", "0"}], ";", "\n", 
      RowBox[{"Ectriplet", "=", "0"}], ";", "\n", "\n", 
      RowBox[{"dRPA", "=", "False"}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"singlet", ",", 
        RowBox[{
         RowBox[{"ispin", "=", "1"}], ";", "\n", "\n", 
         RowBox[{"linearquantities", "=", 
          RowBox[{"LinearResponse", "[", 
           RowBox[{
           "nBas", ",", "nO", ",", "nV", ",", "\[Epsilon]", ",", "ERI", ",", 
            "TDA", ",", 
            RowBox[{"(*", 
             RowBox[{"BSE", ",", "W", ","}], "*)"}], "ispin", ",", "dRPA"}], 
           "]"}]}], ";", "\n", "\n", 
         RowBox[{"Ecsinglet", "=", 
          RowBox[{"linearquantities", "[", "\"\<Ec\>\"", "]"}]}], ";", "\n", 
         RowBox[{"Ecsinglet", "=", 
          RowBox[{"0.5", "Ecsinglet"}]}], ";"}]}], "\n", "]"}], ";", "\n", 
      "\n", 
      RowBox[{"If", "[", 
       RowBox[{"triplet", ",", 
        RowBox[{
         RowBox[{"ispin", "=", "2"}], ";", "\n", "\n", 
         RowBox[{"linearquantities", "=", 
          RowBox[{"LinearResponse", "[", 
           RowBox[{
           "nBas", ",", "nO", ",", "nV", ",", "\[Epsilon]", ",", "ERI", ",", 
            "TDA", ",", 
            RowBox[{"(*", 
             RowBox[{"BSE", ",", "W", ","}], "*)"}], "ispin", ",", "dRPA"}], 
           "]"}]}], ";", "\n", "\n", 
         RowBox[{"Ectriplet", "=", 
          RowBox[{"linearquantities", "[", "\"\<Ec\>\"", "]"}]}], ";", "\n", 
         RowBox[{"Ectriplet", "=", 
          RowBox[{"1.5", "Ectriplet"}]}], ";"}]}], "\n", "]"}], ";", "\n", 
      "\n", 
      RowBox[{"EcRPAx", "=", 
       RowBox[{"Ecsinglet", "+", "Ectriplet"}]}], ";", "\n", 
      RowBox[{"RPAxquantities", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"\"\<EcRPAx\>\"", "\[Rule]", "EcRPAx"}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"Return", "[", "RPAxquantities", "]"}]}]}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.841305899885696*^9, 3.841305929432371*^9}, {
   3.841308037218934*^9, 3.841308067392598*^9}, 3.841308100277718*^9, {
   3.841308158725947*^9, 3.8413081626943207`*^9}, {3.8413085191629953`*^9, 
   3.841308524150217*^9}, {3.846819966469096*^9, 3.8468199722887783`*^9}, {
   3.8468202748920517`*^9, 3.846820317546153*^9}, {3.846820381481173*^9, 
   3.846820400786178*^9}, {3.846821842010838*^9, 3.84682186650874*^9}, {
   3.864292025922748*^9, 3.864292029276567*^9}, {3.8715305634168367`*^9, 
   3.87153057253538*^9}, {3.8715307395914717`*^9, 3.8715307406078367`*^9}, {
   3.871531107857209*^9, 3.871531120704143*^9}, {3.871531179453753*^9, 
   3.871531182887952*^9}, {3.871531786289707*^9, 
   3.871531810181065*^9}},ExpressionUUID->"1133c4df-ae52-4067-a778-\
7a7ede62bd54"]
},
WindowSize->{1177, 691},
WindowMargins->{{Automatic, 46}, {0, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"94f307e6-506a-4c7b-860e-f90bda73bf2d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3428, 78, 762, "Code",ExpressionUUID->"1133c4df-ae52-4067-a778-7a7ede62bd54"]
}
]
*)

