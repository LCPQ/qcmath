(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      6642,        160]
NotebookOptionsPosition[      6263,        145]
NotebookOutlinePosition[      6688,        162]
CellTagsIndexPosition[      6645,        159]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RPA", "[", 
    RowBox[{
    "nBas_", ",", "nO_", ",", "nV_", ",", "\[Epsilon]_", ",", "ERI_", ",", 
     "TDA_", ",", 
     RowBox[{"(*", 
      RowBox[{"BSE_", ",", "W_", ","}], "*)"}], "singlet_", ",", "triplet_", 
     ",", 
     RowBox[{"verbose_", ":", "1"}]}], 
    RowBox[{"(*", 
     RowBox[{"Default", "=", 
      RowBox[{"1", " ", 
       RowBox[{"(", "True", ")"}]}]}], "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ispin", ",", "linearquantities", ",", "Ecsinglet", ",", "Ectriplet", 
       ",", "dRPA", ",", "RPAquantities", ",", "\n", "EcRPA", ",", 
       "\[CapitalOmega]", ",", "TabLR"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"NotebookEvaluate", "[", 
       RowBox[{"path", "<>", "\"\</src/LR/linear_Response.nb\>\""}], "]"}], 
      ";", "\n", "\n", 
      RowBox[{"Ecsinglet", "=", "0"}], ";", "\n", 
      RowBox[{"Ectriplet", "=", "0"}], ";", "\n", "\n", 
      RowBox[{"dRPA", "=", "True"}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"singlet", ",", 
        RowBox[{
         RowBox[{"ispin", "=", "1"}], ";", "\n", "\n", 
         RowBox[{"linearquantities", "=", 
          RowBox[{"LinearResponse", "[", 
           RowBox[{
           "nBas", ",", "nO", ",", "nV", ",", "\[Epsilon]", ",", "ERI", ",", 
            "TDA", ",", 
            RowBox[{"(*", 
             RowBox[{"BSE", ",", "W", ","}], "*)"}], "ispin", ",", "dRPA"}], 
           "]"}]}], ";", "\n", "\n", 
         RowBox[{"\[CapitalOmega]", "=", 
          RowBox[{"linearquantities", "[", "\"\<\[CapitalOmega]\>\"", "]"}]}],
          ";", "\n", 
         RowBox[{"Ecsinglet", "=", 
          RowBox[{"linearquantities", "[", "\"\<Ec\>\"", "]"}]}], ";", "\n", 
         "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbose", "\[Equal]", "1"}], ",", "\n", 
           RowBox[{
            RowBox[{"NotebookEvaluate", "[", 
             RowBox[{"path", "<>", "\"\</src/LR/print_excitation.nb\>\""}], 
             "]"}], ";", "\n", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<RPA outputs:\>\"", ",", "Bold", ",", "Red"}], 
              "]"}], "]"}], ";", "\n", 
            RowBox[{"TabLR", "=", 
             RowBox[{"PrintExcitation", "[", 
              RowBox[{"\"\<RPA\>\"", ",", "ispin", ",", "\[CapitalOmega]"}], 
              "]"}]}], ";", "\n", 
            RowBox[{"Print", "[", "TabLR", "]"}], ";"}]}], "\n", "]"}], 
         ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"triplet", ",", 
        RowBox[{
         RowBox[{"ispin", "=", "2"}], ";", "\n", "\n", 
         RowBox[{"linearquantities", "=", 
          RowBox[{"LinearResponse", "[", 
           RowBox[{
           "nBas", ",", "nO", ",", "nV", ",", "\[Epsilon]", ",", "ERI", ",", 
            "TDA", ",", 
            RowBox[{"(*", 
             RowBox[{"BSE", ",", "W", ","}], "*)"}], "ispin", ",", "dRPA"}], 
           "]"}]}], ";", "\n", "\n", 
         RowBox[{"\[CapitalOmega]", "=", 
          RowBox[{"linearquantities", "[", "\"\<\[CapitalOmega]\>\"", "]"}]}],
          ";", "\n", 
         RowBox[{"Ectriplet", "=", 
          RowBox[{"linearquantities", "[", "\"\<Ec\>\"", "]"}]}], ";", "\n", 
         "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbose", "\[Equal]", "1"}], ",", "\n", 
           RowBox[{
            RowBox[{"NotebookEvaluate", "[", 
             RowBox[{"path", "<>", "\"\</src/LR/print_excitation.nb\>\""}], 
             "]"}], ";", "\n", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<RPA outputs:\>\"", ",", "Bold", ",", "Red"}], 
              "]"}], "]"}], ";", "\n", 
            RowBox[{"TabLR", "=", 
             RowBox[{"PrintExcitation", "[", 
              RowBox[{"\"\<RPA\>\"", ",", "ispin", ",", "\[CapitalOmega]"}], 
              "]"}]}], ";", "\n", 
            RowBox[{"Print", "[", "TabLR", "]"}], ";"}]}], "\n", "]"}], 
         ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"EcRPA", "=", 
       RowBox[{"Ecsinglet", "+", "Ectriplet"}]}], ";", "\n", "\n", 
      RowBox[{"RPAquantities", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"\"\<EcRPA\>\"", "\[Rule]", "EcRPA"}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"Return", "[", "RPAquantities", "]"}]}]}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.8413037715475187`*^9, 3.841303789802655*^9}, 
   3.841303887546039*^9, {3.8413040767141123`*^9, 3.8413041531397963`*^9}, {
   3.841304284266075*^9, 3.841304296144919*^9}, {3.841304421772735*^9, 
   3.841304503235188*^9}, {3.841304718025049*^9, 3.8413047324978733`*^9}, {
   3.8413047721131*^9, 3.8413047773306227`*^9}, {3.8413048371608763`*^9, 
   3.8413048469867783`*^9}, {3.841304920791436*^9, 3.841304922971776*^9}, {
   3.8413056245779657`*^9, 3.841305659250207*^9}, {3.8413057117087517`*^9, 
   3.841305726778667*^9}, {3.8413057839627867`*^9, 3.841305825828639*^9}, {
   3.841306544269328*^9, 3.841306552532071*^9}, {3.8413078968029823`*^9, 
   3.841307901002223*^9}, {3.841308009712099*^9, 3.8413080100817013`*^9}, 
   3.8642917722519913`*^9, 3.8715255801333857`*^9, {3.871526177857114*^9, 
   3.87152619450205*^9}, {3.871526445695731*^9, 3.871526499569556*^9}, {
   3.871526648544387*^9, 3.871526671773904*^9}, {3.871531736972464*^9, 
   3.871531771376383*^9}, {3.872734611468972*^9, 3.872734747111397*^9}, {
   3.872734795470027*^9, 3.872734803958784*^9}, {3.8727348461274443`*^9, 
   3.872734894903832*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"efb756d3-aae8-491f-b48f-7ab34c9c3d6b"]
},
WindowSize->{1053, 686},
WindowMargins->{{Automatic, 188}, {1, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2fafbe13-2a7a-4276-a7e8-43f70fae959c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5701, 123, 1146, "Code",ExpressionUUID->"efb756d3-aae8-491f-b48f-7ab34c9c3d6b"]
}
]
*)

