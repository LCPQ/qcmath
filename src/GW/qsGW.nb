(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     39892,        884]
NotebookOptionsPosition[     38945,        858]
NotebookOutlinePosition[     39372,        875]
CellTagsIndexPosition[     39329,        872]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["qsGW", "Title",
 CellChangeTimes->{{3.898577575152157*^9, 
  3.898577576651058*^9}},ExpressionUUID->"0d6169d2-9cc2-4c10-a2fd-\
b52119c01192"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"qsGW", "[", 
    RowBox[{
    "nElec_", ",", "nBas_", ",", "nO_", ",", "nV_", ",", "ENuc_", ",", 
     "ERHF_", ",", "\[Epsilon]_", ",", "ERI_", ",", "S_", ",", "T_", ",", 
     "V_", ",", "U_", ",", "X_", ",", "C_", ",", "options_", ",", 
     "verbose_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "outputsqsGW", "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"options", "[", "\"\<spinorbital\>\"", "]"}], "==", "True"}],
         ",", "\n", "\n", "\t", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Spin orbital implementation of qsGW not available!\>\"", "]"}],
          ";", "\n", "\t", "\n", "\t", 
         RowBox[{"outputsqsGW", "=", 
          RowBox[{"spinOrbQsGW", "[", 
           RowBox[{
           "nElec", ",", "nBas", ",", "nO", ",", "nV", ",", "ENuc", ",", 
            "ERHF", ",", "\[Epsilon]", ",", "ERI", ",", "S", ",", "T", ",", 
            "V", ",", "U", ",", "X", ",", "C", ",", "options", ",", 
            "verbose"}], "]"}]}], ";"}], "\n", "\t", "\n", "\t", ",", 
        RowBox[{"(*", 
         RowBox[{"else", " ", "go", " ", "to", " ", "spatial"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"outputsqsGW", "=", 
          RowBox[{"spatialQsGW", "[", 
           RowBox[{
           "nElec", ",", "nBas", ",", "nO", ",", "nV", ",", "ENuc", ",", 
            "ERHF", ",", "\[Epsilon]", ",", "ERI", ",", "S", ",", "T", ",", 
            "V", ",", "U", ",", "X", ",", "C", ",", "options", ",", 
            "verbose"}], "]"}]}], ";"}]}], "\t", "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"Return", "[", "outputsqsGW", "]"}], ";"}]}], "\n", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.8780270077633533`*^9, 3.878027080421652*^9}, {
  3.878028387658701*^9, 3.878028471861127*^9}, {3.878028807312209*^9, 
  3.878028826305831*^9}, {3.878031354008052*^9, 3.878031354937872*^9}, {
  3.878033123530241*^9, 3.878033199126441*^9}, {3.878091948824909*^9, 
  3.87809195639154*^9}, {3.878187236578301*^9, 3.8781872519317102`*^9}, {
  3.878187498193687*^9, 3.8781874991659203`*^9}, {3.87818754795763*^9, 
  3.878187559738763*^9}, {3.878187738302698*^9, 3.878187739804028*^9}, {
  3.878200664962863*^9, 3.8782006876520367`*^9}, {3.878200868075748*^9, 
  3.8782008892021103`*^9}, {3.8782707523429337`*^9, 3.87827075928719*^9}, {
  3.878270791848078*^9, 3.8782707921033297`*^9}, {3.898575956982334*^9, 
  3.8985760869904947`*^9}, {3.8986471360560083`*^9, 
  3.898647138691146*^9}},ExpressionUUID->"551203ff-483a-43dd-b703-\
03844f45a5a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spin orbitals", "Title",
 CellChangeTimes->{{3.878013165631377*^9, 
  3.878013168274291*^9}},ExpressionUUID->"97e909e2-77bf-4b98-a001-\
245982342548"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"spinOrbQsGW", "[", 
    RowBox[{
    "nelc_", ",", "nBas_", ",", "nO_", ",", "nV_", ",", "\[Epsilon]_", ",", 
     "ENuc_", ",", "ERHF_", ",", "ERI_", ",", "S_", ",", "T_", ",", "V_", ",",
      "U_", ",", "X_", ",", "C_", ",", "options_", ",", "verbose_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"Return", "[", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<spinorbital implementation not available!!!\>\"", ",", "Bold", 
          ",", "Red"}], "]"}], "]"}], "]"}], ";"}]}], "\n", "\n", "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.898577552374628*^9, 3.8985775625358677`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"d6611c06-b7c9-4201-8bc5-1fc4784f35c8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Spatial orbitals", "Title",
 CellChangeTimes->{{3.878013165631377*^9, 3.878013168274291*^9}, {
  3.878026970810357*^9, 
  3.878026971372881*^9}},ExpressionUUID->"c5a72982-6654-48d0-910d-\
855338d08574"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"spatialQsGW", "[", 
    RowBox[{
    "nElec_", ",", "nBas_", ",", "nO_", ",", "nV_", ",", "ENuc_", ",", 
     "ERHF_", ",", "\[Epsilon]_", ",", "ERI_", ",", "S_", ",", "T_", ",", 
     "V_", ",", "U_", ",", "X_", ",", "C_", ",", "options_", ",", 
     "verbose_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Hcore", ",", "OAIntegrals", ",", "UJ", ",", "UK", ",", "Orb", ",", "P",
        ",", "cGW", ",", "ERIGW", ",", "\[Epsilon]GW", ",", "nSCF", ",", 
       "conv", ",", "J", ",", "K", ",", "dRPA", ",", "ispin", ",", "nS", ",", 
       "eigenvectors", ",", "linearquantities", ",", "\n", "sERI", ",", 
       "\[CapitalOmega]", ",", "EcRPA", ",", "\[CapitalSigma]c", ",", "Fp", 
       ",", "oldEigenvalues", ",", "FDIIS", ",", "eDIIS", ",", "qsstaticform",
        ",", "maxSCF", ",", "thresh", ",", "DIISEx", ",", "\[Eta]", ",", 
       "maxDIIS", ",", "cpGW", ",", "TabqsGW", ",", "\n", "nDIIS", ",", 
       "error", ",", "nBasSq", ",", "TDAW", ",", "tmpF", ",", "tmpErrorDIIS", 
       ",", "FOA", ",", "TDA", ",", "XpY", ",", "EcGM", ",", "qsGET", ",", 
       "qsGEV", ",", "qsGEJ", ",", "qsGEK", ",", "EqsGW", ",", 
       "qsGWquantities"}], "}"}], ",", "\n", "\n", 
     RowBox[{"(*", " ", "options", " ", "*)"}], "\n", 
     RowBox[{
      RowBox[{"maxSCF", "=", 
       RowBox[{"options", "[", "\"\<maxSCF_MBPT\>\"", "]"}]}], ";", "\n", 
      RowBox[{"thresh", "=", 
       RowBox[{"options", "[", "\"\<thresh_MBPT\>\"", "]"}]}], ";", "\n", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"options", "[", "\"\<\[Eta]\>\"", "]"}]}], ";", "\n", 
      RowBox[{"qsstaticform", "=", 
       RowBox[{"options", "[", "\"\<qs_static_form\>\"", "]"}]}], ";", "\n", 
      RowBox[{"DIISEx", "=", 
       RowBox[{"options", "[", "\"\<DIIS\>\"", "]"}]}], ";", "\n", 
      RowBox[{"maxDIIS", "=", 
       RowBox[{"options", "[", "\"\<n_DIIS\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"nDIIS", "=", "0"}], ";", "\n", 
      RowBox[{"TDA", "=", 
       RowBox[{"options", "[", "\"\<TDA\>\"", "]"}]}], ";", "\n", 
      RowBox[{"TDAW", "=", 
       RowBox[{"options", "[", "\"\<TDA_GW\>\"", "]"}]}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"verbose", ",", "\n", "  ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"TDA", "\[Equal]", "True"}], ",", 
           RowBox[{
           "Print", "[", "\"\<Tamm-Dancoff approximation activated!\>\"", 
            "]"}]}], "]"}], ";", "\n", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"TDAW", "\[Equal]", "True"}], ",", 
           RowBox[{
           "Print", "[", 
            "\"\<Tamm-Dancoff approximation for dynamic screening!\>\"", 
            "]"}]}], "]"}], ";"}], "\n", "  ", ",", 
        RowBox[{"(*", "else", "*)"}], "\n", "  ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"TDA", "\[Equal]", "True"}], ",", 
           RowBox[{
           "PrintTemporary", "[", 
            "\"\<Tamm-Dancoff approximation activated!\>\"", "]"}]}], "]"}], 
         ";", "\n", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"TDAW", "\[Equal]", "True"}], ",", 
           RowBox[{
           "PrintTemporary", "[", 
            "\"\<Tamm-Dancoff approximation for dynamic screening!\>\"", 
            "]"}]}], "]"}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"dRPA", "=", "True"}], ";", "\n", 
      RowBox[{"ispin", "=", "1"}], ";", "\n", 
      RowBox[{"nS", "=", 
       RowBox[{"nO", "*", "nV"}]}], ";", "\n", 
      RowBox[{"nBasSq", "=", 
       RowBox[{"nBas", "*", "nBas"}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"Hcore", " ", "=", " ", 
       RowBox[{"T", " ", "+", " ", "V"}]}], ";", "\n", 
      RowBox[{"OAIntegrals", " ", "=", " ", "U"}], ";", "\n", 
      RowBox[{"UJ", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"OAIntegrals", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "3", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"UK", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"OAIntegrals", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "4", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"Orb", "=", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"C", "\[Transpose]"}], ",", 
          RowBox[{"nElec", "/", "2"}]}], "]"}], "\[Transpose]"}]}], ";", "\n", 
      RowBox[{"P", "=", 
       RowBox[{"2", 
        RowBox[{"Orb", ".", 
         RowBox[{"Orb", "\[Transpose]"}]}]}]}], ";", "\n", 
      RowBox[{"cGW", "=", "C"}], ";", "\n", 
      RowBox[{"ERIGW", "=", "ERI"}], ";", "\n", 
      RowBox[{"\[Epsilon]GW", "=", "\[Epsilon]"}], ";", "\n", 
      RowBox[{"oldEigenvalues", "=", "\[Epsilon]"}], ";", "\n", "\n", 
      RowBox[{"(*", "Initialization", "*)"}], "\n", 
      RowBox[{"FDIIS", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nBasSq"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "maxDIIS"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"eDIIS", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nBasSq"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "maxDIIS"}], "}"}]}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"SCF", " ", "loop"}], "*)"}], "\n", " ", 
      RowBox[{"nSCF", " ", "=", " ", 
       RowBox[{"-", "1"}]}], ";", " ", 
      RowBox[{"conv", "=", "1"}], ";", " ", "\n", " ", "\n", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"conv", " ", ">", " ", "thresh"}], " ", "\[And]", " ", 
         RowBox[{"nSCF", " ", "<", " ", "maxSCF"}]}], ",", " ", 
        RowBox[{
         RowBox[{"nSCF", "++"}], ";", " ", "\n", "\n", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "\[Epsilon]", "]"}], "\[Equal]", "Null"}], 
           ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\n", "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{"Build", " ", "Coulomb", " ", "matrix"}], "*)"}], "\n", 
         "  ", 
         RowBox[{"J", "=", 
          RowBox[{"UJ", ".", 
           RowBox[{"Flatten", "[", "P", "]"}]}]}], ";", "\n", "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Exchange", " ", "part", " ", "of", " ", "the", " ", "self"}], "-",
            "energy"}], "*)"}], "\n", "  ", 
         RowBox[{"K", "=", 
          RowBox[{"UK", ".", 
           RowBox[{"Flatten", "[", "P", "]"}]}]}], ";", "\n", "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{"Two", "-", 
           RowBox[{
           "electrons", " ", "integrals", " ", "in", " ", "MO", " ", 
            "basis"}]}], "*)"}], "\n", "  ", 
         RowBox[{"ERIGW", "=", 
          RowBox[{
           RowBox[{"cGW", "\[Transpose]"}], ".", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"cGW", "\[Transpose]"}], ".", "OAIntegrals", ".", 
              "cGW"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1", ",", "4", ",", "3"}], "}"}]}], "]"}], 
           ".", "cGW"}]}], ";", "\n", "\n", "  ", 
         RowBox[{"NotebookEvaluate", "[", 
          RowBox[{"path", "<>", "\"\</src/LR/linear_Response.nb\>\""}], "]"}],
          ";", "\n", "  ", 
         RowBox[{"linearquantities", "=", 
          RowBox[{"LinearResponse", "[", 
           RowBox[{
           "nBas", ",", "nO", ",", "nV", ",", "\[Epsilon]GW", ",", "ERIGW", 
            ",", "TDAW", ",", "ispin", ",", "dRPA"}], "]"}]}], ";", "\n", 
         "  ", 
         RowBox[{"\[CapitalOmega]", "=", 
          RowBox[{"linearquantities", "[", "\"\<\[CapitalOmega]\>\"", "]"}]}],
          ";", "\n", "  ", 
         RowBox[{"XpY", "=", 
          RowBox[{"linearquantities", "[", "\"\<XpY\>\"", "]"}]}], ";", "\n", 
         "  ", 
         RowBox[{"EcRPA", "=", 
          RowBox[{"linearquantities", "[", "\"\<Ec\>\"", "]"}]}], ";", "\n", 
         "\n", "  ", 
         RowBox[{"NotebookEvaluate", "[", 
          RowBox[{"path", "<>", "\"\</src/GW/GW_excitation_density.nb\>\""}], 
          "]"}], ";", "\n", "  ", 
         RowBox[{"sERI", "=", 
          RowBox[{"GWExcitationDensity", "[", 
           RowBox[{"nBas", ",", "nO", ",", "nS", ",", "ERIGW", ",", "XpY"}], 
           "]"}]}], ";", "\n", "\n", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"qsstaticform", "==", "\"\<Sym\>\""}], ",", "\n", "    ", 
           RowBox[{
            RowBox[{"\[CapitalSigma]c", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"i", "=", "1"}], "nO"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"jb", "=", "1"}], "nS"], 
                  FractionBox[
                   RowBox[{"2", " ", 
                    RowBox[{"sERI", "\[LeftDoubleBracket]", 
                    RowBox[{"p", ",", "i", ",", "jb"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"sERI", "\[LeftDoubleBracket]", 
                    RowBox[{"q", ",", "i", ",", "jb"}], 
                    "\[RightDoubleBracket]"}]}], 
                   RowBox[{
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "p", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "\[CapitalOmega]", "\[LeftDoubleBracket]", "jb", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Eta]"}]}]]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"a", "=", 
                   RowBox[{"nO", "+", "1"}]}], "nBas"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"jb", "=", "1"}], "nS"], 
                  FractionBox[
                   RowBox[{"2", " ", 
                    RowBox[{"sERI", "\[LeftDoubleBracket]", 
                    RowBox[{"p", ",", "a", ",", "jb"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"sERI", "\[LeftDoubleBracket]", 
                    RowBox[{"q", ",", "a", ",", "jb"}], 
                    "\[RightDoubleBracket]"}]}], 
                   RowBox[{
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "p", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "a", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "\[CapitalOmega]", "\[LeftDoubleBracket]", "jb", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Eta]", " "}]}]]}]}]}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"p", ",", "nBas"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"q", ",", "nBas"}], "}"}]}], "]"}]}], ";", "\n", 
            "    ", 
            RowBox[{"\[CapitalSigma]c", " ", "=", " ", 
             RowBox[{"Re", "[", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", 
                RowBox[{"\[CapitalSigma]c", "+", 
                 RowBox[{"\[CapitalSigma]c", "\[Transpose]"}]}], ")"}]}], 
              "]"}]}], ";"}]}], "\n", "  ", "]"}], ";", "\n", "\n", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"qsstaticform", "==", "\"\<SRG\>\""}], ",", "\n", "    ", 
           RowBox[{
            RowBox[{"\[CapitalSigma]c", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"i", "=", "1"}], "nO"], 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"jb", "=", "1"}], "nS"], 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "p", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "q", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{
                    "\[CapitalOmega]", "\[LeftDoubleBracket]", "jb", 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "p", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "\[CapitalOmega]", "\[LeftDoubleBracket]", "jb", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "q", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "\[CapitalOmega]", "\[LeftDoubleBracket]", "jb", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"]}]], "2", " ", 
                  RowBox[{"sERI", "\[LeftDoubleBracket]", 
                   RowBox[{"p", ",", "i", ",", "jb"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"sERI", "\[LeftDoubleBracket]", 
                   RowBox[{"q", ",", "i", ",", "jb"}], 
                   "\[RightDoubleBracket]"}]}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"p", ",", "nBas"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"q", ",", "nBas"}], "}"}]}], "]"}]}], ";", "\n", 
            "    ", 
            RowBox[{"\[CapitalSigma]c", " ", "=", " ", 
             RowBox[{"\[CapitalSigma]c", " ", "+", " ", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"a", "=", 
                   RowBox[{"nO", "+", "1"}]}], "nBas"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"jb", "=", "1"}], "nS"], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "p", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "q", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "a", 
                    "\[RightDoubleBracket]"}]}], "-", 
                    RowBox[{
                    "\[CapitalOmega]", "\[LeftDoubleBracket]", "jb", 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "p", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "a", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "\[CapitalOmega]", "\[LeftDoubleBracket]", "jb", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "q", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "\[Epsilon]GW", "\[LeftDoubleBracket]", "a", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "\[CapitalOmega]", "\[LeftDoubleBracket]", "jb", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"]}]], "2", " ", 
                   RowBox[{"sERI", "\[LeftDoubleBracket]", 
                    RowBox[{"p", ",", "a", ",", "jb"}], 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"sERI", "\[LeftDoubleBracket]", 
                    RowBox[{"q", ",", "a", ",", "jb"}], 
                    "\[RightDoubleBracket]"}]}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"p", ",", "nBas"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"q", ",", "nBas"}], "}"}]}], "]"}]}]}]}]}], "\n", 
          "  ", "]"}], ";", "\n", "\n", "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{"Self", "-", 
           RowBox[{"Energy", " ", "in", " ", "AO", " ", "basis"}]}], "*)"}], 
         "\n", "  ", 
         RowBox[{"\[CapitalSigma]c", " ", "=", " ", 
          RowBox[{"S", ".", "cGW", ".", "\[CapitalSigma]c", ".", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"S", ".", "cGW"}], ")"}], "\[Transpose]"}]}]}], ";", 
         "\n", "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{
          "qsGW", " ", "Fock", " ", "matrix", " ", "in", " ", "AO", " ", 
           "basis"}], "*)"}], "\n", "  ", 
         RowBox[{"FOA", " ", "=", " ", 
          RowBox[{"Hcore", " ", "+", " ", "J", " ", "-", " ", 
           RowBox[{"0.5", "K"}], "+", " ", "\[CapitalSigma]c"}]}], ";", " ", 
         "\n", "\n", "  ", 
         RowBox[{"error", "=", 
          RowBox[{
           RowBox[{"FOA", ".", "P", ".", "S"}], "-", 
           RowBox[{"S", ".", "P", ".", "FOA"}]}]}], ";", "\n", "\n", "  ", 
         RowBox[{"If", "[", 
          RowBox[{"DIISEx", ",", "\n", "    ", 
           RowBox[{
            RowBox[{"NotebookEvaluate", "[", 
             RowBox[{"path", "<>", "\"\</src/utils/DIIS.nb\>\""}], "]"}], ";",
             "\n", "    ", 
            RowBox[{"nDIIS", "=", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"nDIIS", "+", "1"}], ",", "maxDIIS"}], "]"}]}], ";", 
            "\n", "    ", 
            RowBox[{"error", "=", 
             RowBox[{"Flatten", "[", "error", "]"}]}], ";", "\n", "    ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"tmpF", ",", "tmpErrorDIIS", ",", "FOA"}], "}"}], "=", 
             RowBox[{"DIIS", "[", 
              RowBox[{"nBasSq", ",", "nBasSq", ",", "nDIIS", ",", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{"eDIIS", "\[Transpose]"}], ",", "nDIIS"}], "]"}], 
                "\[Transpose]"}], ",", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{"FDIIS", "\[Transpose]"}], ",", "nDIIS"}], "]"}], 
                "\[Transpose]"}], ",", "error", ",", "FOA"}], "]"}]}], ";", 
            "\n", "    ", 
            RowBox[{
             RowBox[{"eDIIS", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", 
               RowBox[{"1", ";;", "nDIIS"}]}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{"tmpErrorDIIS", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", 
               RowBox[{"1", ";;", "nDIIS"}]}], "\[RightDoubleBracket]"}]}], 
            ";", "\n", "    ", 
            RowBox[{
             RowBox[{"FDIIS", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", 
               RowBox[{"1", ";;", "nDIIS"}]}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{"tmpF", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", 
               RowBox[{"1", ";;", "nDIIS"}]}], "\[RightDoubleBracket]"}]}], 
            ";"}]}], "\n", "  ", "]"}], ";", "\n", "  ", "\n", "  ", 
         RowBox[{"FOA", "=", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{"FOA", ",", 
            RowBox[{"{", 
             RowBox[{"nBas", ",", "nBas"}], "}"}]}], "]"}]}], ";", "\n", "\n",
          "  ", 
         RowBox[{"(*", 
          RowBox[{
          "Fock", " ", "matrix", " ", "in", " ", "orthogonal", " ", "basis"}],
           "*)"}], "\n", "  ", 
         RowBox[{"Fp", "=", " ", 
          RowBox[{
           RowBox[{"X", "\[Transpose]"}], ".", "FOA", ".", "X"}]}], ";", " ", 
         
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"F", "'"}], "=", 
           RowBox[{
            SuperscriptBox["X", "\[Dagger]"], ".", "F", ".", "X"}]}], "*)"}], 
         "\n", "\n", "  ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Epsilon]GW", ",", "cpGW"}], "}"}], "=", " ", 
          RowBox[{"SortEigensystem", "[", 
           RowBox[{"Eigensystem", "[", "Fp", "]"}], "]"}]}], ";", " ", 
         RowBox[{"cpGW", "=", 
          RowBox[{"cpGW", "\[Transpose]"}]}], ";", "\n", "\n", "  ", 
         RowBox[{"cGW", "=", " ", 
          RowBox[{"X", ".", "cpGW"}]}], ";", " ", 
         RowBox[{"(*", 
          RowBox[{"C", "=", 
           RowBox[{"X", ".", 
            RowBox[{"C", "'"}]}]}], "*)"}], " ", 
         RowBox[{"Orb", "=", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{"cGW", "\[Transpose]"}], ",", 
             RowBox[{"nElec", "/", "2"}]}], "]"}], "\[Transpose]"}]}], ";", 
         "\n", "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{"Back", "-", 
           RowBox[{"Transform", " ", "the", " ", "Self"}], "-", 
           RowBox[{"Energy", " ", "in", " ", "MO", " ", "basis"}]}], "*)"}], 
         "\n", "  ", 
         RowBox[{"\[CapitalSigma]c", " ", "=", " ", 
          RowBox[{
           RowBox[{"cGW", "\[Transpose]"}], ".", "\[CapitalSigma]c", ".", 
           "cGW"}]}], ";", " ", "\n", "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{
          "Density", " ", "matrix", " ", "in", " ", "AO", " ", "basis"}], 
          "*)"}], "\n", "  ", 
         RowBox[{"P", "=", 
          RowBox[{"2", 
           RowBox[{"Orb", ".", 
            RowBox[{"Orb", "\[Transpose]"}]}]}]}], ";", "\n", "  ", "\n", 
         "  ", 
         RowBox[{"conv", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{"\[Epsilon]GW", "-", "oldEigenvalues"}], "]"}], "]"}]}], 
         ";", "\n", "  ", 
         RowBox[{"oldEigenvalues", " ", "=", " ", "\[Epsilon]GW"}], ";", "\n",
          "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{"Kinetic", " ", "energy"}], "*)"}], "\n", "  ", 
         RowBox[{"qsGET", "=", 
          RowBox[{"Tr", "[", 
           RowBox[{"P", ".", "T"}], "]"}]}], ";", "\n", "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{"Nuclear", " ", "energy"}], "*)"}], "\n", "  ", 
         RowBox[{"qsGEV", "=", 
          RowBox[{"Tr", "[", 
           RowBox[{"P", ".", "V"}], "]"}]}], ";", "\n", "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{"Coulomb", " ", "energy"}], "*)"}], "\n", "  ", 
         RowBox[{"qsGEJ", "=", " ", 
          RowBox[{"0.5", 
           RowBox[{"Tr", "[", 
            RowBox[{"P", ".", "J"}], "]"}]}]}], ";", "\n", "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{"Exchange", " ", "energy"}], "*)"}], "\n", "  ", 
         RowBox[{"qsGEK", "=", " ", 
          RowBox[{
           RowBox[{"-", "0.25"}], 
           RowBox[{"Tr", "[", 
            RowBox[{"P", ".", "K"}], "]"}]}]}], ";", "\n", "\n", "  ", 
         RowBox[{"EqsGW", " ", "=", " ", 
          RowBox[{
          "qsGET", " ", "+", " ", "qsGEV", " ", "+", " ", "qsGEJ", " ", "+", 
           " ", "qsGEK"}]}], ";", "\n", "\n", "  ", 
         RowBox[{"(*", 
          RowBox[{
          "Galitskii", " ", "Migdal", " ", "correlation", " ", "energy"}], 
          "*)"}], "\n", "  ", 
         RowBox[{"EcGM", "=", 
          RowBox[{"(*", 
           FractionBox["1", "2"], "*)"}], 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"i", "=", "1"}], "nO"], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"a", "=", 
              RowBox[{"nO", "+", "1"}]}], "nBas"], 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"jb", "=", "1"}], "nS"], 
             RowBox[{"-", 
              FractionBox[
               RowBox[{"4", 
                SuperscriptBox[
                 RowBox[{"sERI", "\[LeftDoubleBracket]", 
                  RowBox[{"a", ",", "i", ",", "jb"}], 
                  "\[RightDoubleBracket]"}], "2"], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "\[Epsilon]GW", "\[LeftDoubleBracket]", "a", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{
                  "\[Epsilon]GW", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "+", 
                  RowBox[{
                  "\[CapitalOmega]", "\[LeftDoubleBracket]", "jb", 
                   "\[RightDoubleBracket]"}]}], ")"}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "\[Epsilon]GW", "\[LeftDoubleBracket]", "a", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                   "\[Epsilon]GW", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "+", 
                   RowBox[{
                   "\[CapitalOmega]", "\[LeftDoubleBracket]", "jb", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"], "+", 
                SuperscriptBox["\[Eta]", "2"]}]]}]}]}]}]}], ";"}]}], "\n", 
       "\n", "]"}], ";", "\n", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nSCF", "\[Equal]", "maxSCF"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<Convergence failed for qsGW!\>\"", ",", "Red", ",", "Bold"}], 
          "]"}], "]"}]}], "]"}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbose", "\[Equal]", "True"}], ",", "\n", "  ", 
        RowBox[{
         RowBox[{"NotebookEvaluate", "[", 
          RowBox[{"path", "<>", "\"\</src/GW/print_qsGW.nb\>\""}], "]"}], ";",
          "\n", "  ", 
         RowBox[{"TabqsGW", "=", 
          RowBox[{"PrintQsGW", "[", 
           RowBox[{"nO", ",", "\[Epsilon]", ",", 
            RowBox[{"Diagonal", "[", "\[CapitalSigma]c", "]"}], ",", 
            "\[Epsilon]GW", ",", "ENuc", ",", "ERHF", ",", "EcRPA", ",", 
            "EcGM"}], "]"}]}], ";", "\n", "  ", 
         RowBox[{"Print", "[", "TabqsGW", "]"}], ";"}]}], "\n", "]"}], ";", 
      "\n", "\n", 
      RowBox[{"qsGWquantities", "=", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"\"\<nSCF\>\"", "\[Rule]", "nSCF"}], ",", 
         RowBox[{"\"\<conv\>\"", "\[Rule]", "conv"}], ",", 
         RowBox[{"\"\<soeG0W0\>\"", "\[Rule]", "\[Epsilon]GW"}], ",", 
         RowBox[{"\"\<EqsGW\>\"", "\[Rule]", "EqsGW"}], ",", 
         RowBox[{"\"\<EcGM\>\"", "\[Rule]", "EcGM"}], ",", "\n", 
         "                           ", 
         RowBox[{"\"\<EcRPA\>\"", "\[Rule]", "EcRPA"}], ",", 
         RowBox[{"\"\<EtotRPA\>\"", "\[Rule]", 
          RowBox[{"EqsGW", "+", "EcRPA", "+", "ENuc"}]}]}], "]"}]}], ";", 
      "\n", "                     ", "\n", 
      RowBox[{"Return", "[", "qsGWquantities", "]"}], ";"}]}], "\n", "\n", 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.878013177588629*^9, 3.878013182127511*^9}, {
   3.878014008565085*^9, 3.878014023881579*^9}, {3.878014493292346*^9, 
   3.8780145298305902`*^9}, {3.87801457574223*^9, 3.878014578024104*^9}, {
   3.8780146223461933`*^9, 3.878014651832877*^9}, {3.878014891427265*^9, 
   3.8780148928789577`*^9}, {3.8780150702351217`*^9, 3.878015125772881*^9}, {
   3.878015477818611*^9, 3.878015512035926*^9}, {3.878015559633431*^9, 
   3.878015559761335*^9}, {3.8780156001057873`*^9, 3.878015685584938*^9}, {
   3.878015810099504*^9, 3.878015845376349*^9}, {3.8780159890439243`*^9, 
   3.878015989540872*^9}, {3.878016039788898*^9, 3.8780161507716103`*^9}, {
   3.878019723348209*^9, 3.878019754050428*^9}, {3.878020098959834*^9, 
   3.878020195931774*^9}, {3.878020244395625*^9, 3.878020278159113*^9}, {
   3.878020472632283*^9, 3.878020557300784*^9}, {3.8780205940152693`*^9, 
   3.8780206476860332`*^9}, {3.8780207748686237`*^9, 
   3.8780208276455097`*^9}, {3.878021000648662*^9, 3.878021029495749*^9}, {
   3.878021060394876*^9, 3.8780210622727823`*^9}, {3.878021263196478*^9, 
   3.878021268907455*^9}, {3.8780214043707857`*^9, 3.8780214768937197`*^9}, {
   3.878021514381401*^9, 3.878021535458387*^9}, 3.878027098087151*^9, {
   3.878027140500991*^9, 3.878027206567319*^9}, {3.878027237780307*^9, 
   3.8780274177609587`*^9}, {3.8780274480138063`*^9, 3.878027498174474*^9}, {
   3.87802799450905*^9, 3.878028256890699*^9}, {3.878028309880918*^9, 
   3.878028334521207*^9}, {3.878028431740727*^9, 3.8780284360875263`*^9}, 
   3.878028801022764*^9, {3.878031360919858*^9, 3.8780313621487417`*^9}, {
   3.878031408914487*^9, 3.878031409104742*^9}, {3.8780315228494*^9, 
   3.878031614187496*^9}, {3.8780317058504753`*^9, 3.8780317104151363`*^9}, {
   3.8780319211247807`*^9, 3.8780319375817537`*^9}, {3.878031968544702*^9, 
   3.878031989808592*^9}, {3.8780331814180527`*^9, 3.878033189105706*^9}, {
   3.8780332518987083`*^9, 3.87803326789182*^9}, {3.878033315599164*^9, 
   3.878033326110737*^9}, {3.8780334579460363`*^9, 3.878033458838032*^9}, {
   3.878033596935409*^9, 3.8780336986472588`*^9}, {3.878033731986903*^9, 
   3.878033805571723*^9}, {3.878033903101667*^9, 3.87803391105865*^9}, {
   3.8780339569305277`*^9, 3.878033969690197*^9}, {3.878034144764401*^9, 
   3.8780341457761707`*^9}, {3.878034373095612*^9, 3.8780343759235363`*^9}, {
   3.878034414743*^9, 3.878034420375594*^9}, {3.878034508060257*^9, 
   3.87803453033692*^9}, {3.878034589729907*^9, 3.8780346180224123`*^9}, {
   3.878091102617989*^9, 3.878091176384109*^9}, {3.8780912153064833`*^9, 
   3.878091237317461*^9}, {3.8780913216509333`*^9, 3.8780913980979557`*^9}, {
   3.878091452580105*^9, 3.878091473883172*^9}, {3.878091931936496*^9, 
   3.87809194261806*^9}, 3.878092078208675*^9, {3.8780921163282337`*^9, 
   3.878092116586803*^9}, {3.878092171746593*^9, 3.87809220253574*^9}, {
   3.878096777952636*^9, 3.878096781038219*^9}, 3.878096841247589*^9, {
   3.8780970474152517`*^9, 3.8780970475747004`*^9}, {3.8780970946166887`*^9, 
   3.878097109106286*^9}, {3.87809715245324*^9, 3.8780971545148706`*^9}, 
   3.878097213845018*^9, {3.878187543865621*^9, 3.87818760931647*^9}, {
   3.87818764689464*^9, 3.878187696061091*^9}, {3.878200733126852*^9, 
   3.878200795216049*^9}, {3.878200906468775*^9, 3.878201006271124*^9}, {
   3.8782012929040318`*^9, 3.878201311441125*^9}, {3.878201342300809*^9, 
   3.878201366922439*^9}, 3.878269157601026*^9, {3.8782711503274508`*^9, 
   3.8782711862878323`*^9}, {3.878271233317181*^9, 3.878271255249147*^9}, {
   3.878271307803379*^9, 3.87827137893622*^9}, {3.878271935498564*^9, 
   3.8782719449793997`*^9}, {3.8785604377618*^9, 3.878560441063308*^9}, {
   3.8785609853700447`*^9, 3.878561034413275*^9}, {3.878561652324366*^9, 
   3.87856166432589*^9}, {3.898576096379335*^9, 3.898576137068963*^9}, {
   3.89857616835253*^9, 3.898576177359968*^9}, {3.89857639705378*^9, 
   3.898576451904207*^9}, {3.898576496517654*^9, 3.898576630296771*^9}, {
   3.898576984354528*^9, 3.898577108618102*^9}, {3.89857714305552*^9, 
   3.898577169204015*^9}, {3.89857720950204*^9, 3.898577396996728*^9}, {
   3.898577434829639*^9, 3.898577524574638*^9}, {3.898577783478861*^9, 
   3.898577788599387*^9}, {3.898577926710552*^9, 3.898577927009729*^9}, 
   3.898579296609028*^9, {3.898582523661799*^9, 3.8985825346041718`*^9}, {
   3.898582698524849*^9, 3.898582704574107*^9}, {3.898582928371945*^9, 
   3.898582940249854*^9}, 3.898584413845889*^9, 3.8985844846455193`*^9, {
   3.898584836527032*^9, 3.8985848501563168`*^9}, {3.8985871692746162`*^9, 
   3.898587367026849*^9}, {3.898587408403832*^9, 3.898587495571993*^9}, {
   3.898590161316176*^9, 3.898590169051549*^9}, {3.898590203125824*^9, 
   3.8985902522370167`*^9}, {3.898590292026228*^9, 3.8985903137624197`*^9}, 
   3.898590631041603*^9, 3.898591423498537*^9, {3.89859174395576*^9, 
   3.898591745909857*^9}, {3.8985922733451967`*^9, 3.898592276104281*^9}, 
   3.898592372290102*^9, 3.898592477781008*^9, {3.8985931313206377`*^9, 
   3.898593204690789*^9}, {3.898649256841783*^9, 3.898649260048059*^9}, {
   3.898652357767179*^9, 3.89865235880364*^9}, {3.8986530231137333`*^9, 
   3.898653027695239*^9}, {3.898654151036119*^9, 
   3.898654154880365*^9}},ExpressionUUID->"813ac4d2-7a26-4041-a570-\
82cb6537f47e"]
}, Open  ]]
},
WindowSize->{1191, 776},
WindowMargins->{{Automatic, 82}, {-382, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"952680b1-9727-4beb-8f22-475af08b8327"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 147, 3, 123, "Title",ExpressionUUID->"0d6169d2-9cc2-4c10-a2fd-b52119c01192"],
Cell[730, 27, 2702, 55, 402, "Code",ExpressionUUID->"551203ff-483a-43dd-b703-03844f45a5a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3469, 87, 156, 3, 123, "Title",ExpressionUUID->"97e909e2-77bf-4b98-a001-245982342548"],
Cell[3628, 92, 843, 20, 162, "Code",ExpressionUUID->"d6611c06-b7c9-4201-8bc5-1fc4784f35c8"]
}, Closed]],
Cell[CellGroupData[{
Cell[4508, 117, 208, 4, 89, "Title",ExpressionUUID->"c5a72982-6654-48d0-910d-855338d08574"],
Cell[4719, 123, 34210, 732, 3875, "Code",ExpressionUUID->"813ac4d2-7a26-4041-a570-82cb6537f47e"]
}, Open  ]]
}
]
*)

